# Домашнее задание к занятию «Репликация и масштабирование. Часть 2» - Белов Антон


### Задание 1

Опишите основные преимущества использования масштабирования методами:

- Активный master-сервер и пассивный репликационный slave-сервер;(горизонтальное масштабирование)
   – классический пример репликации, выполненной в рамках предыдущего домашнего задания. Основные преимущества:
   - рост производительности чтения данных;
   - повышение отказоустойчивости и надежности;
   - рост доступности данных и скорости их чтения;
   - удобство обслуживания (поскольку slave-сервер содержит данные только для чтения, то можно запускать процессы обслуживающие базу данных не прерывая работу системы).
     
- Master-сервер и несколько slave-серверов;(горизонтальное масштабирование)
    – обладает теми же преимуществами, что и репликация, описанная выше, схема обычно используется в системах, где преобладают запросы на чтение данных (они распределяются между slave-серверами). Основное преимущество такого подхода – удобство распределения данных  (в том числе по географическому признаку). Например, можно установить сервера в разных городах на большом расстоянии друг от друга, перенаправлять клиентов и  выбирать сервер в зависимости от региона. Таким образом мы получаем выигрыш за счет уменьшения пути путешествия запроса к серверу. По сравнению со схемой с одним slave-сервером обладает более высокой доступностью и скоростью чтения данных, но с точки зрения надежности определенного выигрыша нет, так как при потере .
  
- Aктивный сервер со специальным механизмом репликации — distributed replicated block device (DRBD);(отказоустойчивость)
  DRBD, является частью ядра Linux и позволяет повысить  отказоустойчивость системы из нескольких серверов, объединяя данные в один RAID массив (RAID1). Данные реплицируются в виде зеркального отображения содержимого блочных устройств (жестких дисков, разделов, логических томов и т.д.) между хостами. Преимущества:
   - репликация происходит непрерывно и в режиме реального времени;
   - данные отображаются как синхронно, так и асинхронно, при синхронном отображении приложения получают уведомления о завершении записи после выполнения операций записи на всех подключенных хостах, а при асинхронном – приложения получают уведомления о завершении записи, когда записи завершаются локально, что обычно происходит до того, как они распространяются на другие хосты.

- SAN-кластер.(отказоустойчивость)
 Технология для подключения внешних устройств хранения данных к серверам. Предназначена для объединения ресурсов дисковой памяти, подключаемых к одному или нескольким серверам. Как правило, характеризуется высокой пропускной способностью между элементами дисковой системы. Преимущества:
   - удобство эксплуатации за счет простого управления дисковыми устройствами (подключение и монтирование дисков и томов);
   - быстродействие за счет независимости от трафика LAN и WAN-сетей и возможность резервирования данных без загрузки локальной сети и серверов;
   - отказоустойчивость (если одно устройство выходит из строя, тут же подключается и монтируется другое устройство).



### Задание 2


Разработайте план для выполнения горизонтального и вертикального шаринга базы данных. База данных состоит из трёх таблиц: 

- пользователи, 
- книги, 
- магазины (столбцы произвольно). 

Опишите принципы построения системы и их разграничение или разбивку между базами данных.

Представим, что это база данных небольшого книжного интернет-магазина. Всего на нашем портале зарегистрировано 400 пользователей, данные о пользователях у нас размещены в таблице Users. Для повышения ее производительности и уменьшения скорости обработки запросов разделим ее на 2 части (выполним  партицирование). Можно делить таблицу с пользователями на более мелкие составные таблицы, но чтобы не слишком усложнять, выполним партицирование на 2 части по users_id. При развитии нашей клиентской базы, данные каждых следующих 200 вновь зарегистрированных пользователей мы будем хранить в отдельных таблицах.

Информация об ассортименте книжной продукции нашего магазина будут хранится в таблице books. Таблицы books и users должны быть связаны между собой, так можно видеть, какие книги заказывают чаще всего, чтобы более качественно планировать закупки и корректировать ассортимент. Свяжем их через books_id (можно попробовать выполнить связь через заказы orders_id, так как в одном заказе может быть несколько книг, но данный подход потребует от нас создания дополнительнгой таблицы с заказами, а по условиям задания - у нас их 3, так что принимаем решение - не усложнять). Партицирование  осуществляем аналогично таблице Users.

Третья таблица - магазины (stores). Это могут быть как оффлайн-точки продаж, так и онлайн-площадки. Скорее всего их немного, так что горизонтальное партицирование к данной таблице применяться не будет. Данная таблица предполагается кратно меньше предыдущих двух, следовательно шардинг данной таблицы нецелесообразен. Таблица stores будет связана с остальными двумя таблицами через books_id (чтобы понимать ассортимент в каждой точке продаж) и users_id (чтобы понять, насколько наши магазины посещаемы).

Что касается горизонтального шардинга, то есть разнесения наших таблиц по разным серверам, то он целесообразен при гораздо более внушительном объеме данных (счет должен идти на десятки тысяч строк и выше). В нашем случае в целях повышения отказоустойчивости предлагается выполнить репликацию базы данных на второй сервер.

 

## Дополнительные задания (со звёздочкой*)
Эти задания дополнительные, то есть не обязательные к выполнению, и никак не повлияют на получение вами зачёта по этому домашнему заданию. Вы можете их выполнить, если хотите глубже шире разобраться в материале.

---
### Задание 3*

Выполните настройку выбранных методов шардинга из задания 2.

*Пришлите конфиг Docker и SQL скрипт с командами для базы данных*.
